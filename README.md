# <img src="https://user-images.githubusercontent.com/89140546/228543011-56f19954-b8f5-48ca-8884-94086ea78f05.png" width="30" height="30"> The Weakest

> `몰입캠프 Week4 Project: The Weakest` 팀 프로젝트를 업그레이트한 개인 프로젝트
> https://github.com/Yijun-Jeon/madcamp_week4
## Table Of Contents
* [프로젝트 개요](#프로젝트-개요)
* [게임 설명](#게임-설명)
    * [초기 화면](#초기-화면)
    * [대기실 화면](#대기실-화면)
    * [게임 화면](#게임-화면)
    * [종료 화면](#종료-화면)
* [세부 특징](#세부-특징)
* [추가된 기능](#추가된-기능)
* [구현할 기능](#구현할-기능)
* [참고자료](#참고자료)
***

## 프로젝트 개요
기존 The Weakest는 포톤 서버를 활용하였기 때문에 최대 유저 접속 수가 20명으로 제한이 되었고 게임 추가 개발과 유지 보수가 어려웠다. 따라서 개인 서버를 구현하여 활용하고자 프로젝트를 시작하였다.

서버는 소켓 서버로 서버의 모든 구조를 일일이 처음부터 만들었다. 클라이언트는 기존 The Weakest 프로젝트를 토대로 하되, 서버에 맞는 형태로 처음부터 재구성 하였다.

* 클라이언트 : Unity 2021.3.17f + C#
* 서버 : C# + .Net Core 3.1 + Google Protobuf

## 게임 설명

The Weakest는 다수의 플레이어가 함께 즐길 수 있는 탑다운 전략 생존 게임이다. 몰입캠프의 마지막 주를 기념하기 위해 분반 친구들이 다함께 즐길 수 있는 간단한 심리전을 떠올리다가 탄생하게 되었다.

플레이어들은 게임 시작과 동시에 유일한 랜덤 공격력을 받는다. 모든 플레이어는 죽기 전까지는 내 공격력를 알 수 없으며 상대방의 공격력만 볼 수 있다. 따라서 상대방의 공격력를 보고 눈치를 보면서 생존 전략을 구상해야 한다. 플레이어 주변에 빨간 원안에 있는 상대방을 공격하면 상대방과 나 중 공격력이 적은 플레이어가 죽는다. 살아있는 플레이어 중 공격력이 가장 작은 꼴등 플레이어는 알림과 이동속도 버프를 받게 되며, 모든 플레이어가 누가 꼴등인지 알 수 있다. 제한 시간 내에 꼴등 플레이어로 생존하거나, 공격력이 가장 큰 플레이어로 모든 플레이어를 죽이면 우승할 수 있다.


### 초기 화면
![](https://i.imgur.com/xwz2fn2.gif)

`이름 입력`창에 이름을 입력하고 `접속` 버튼을 누르면 해당 이름으로 게임에 접속할 수 있다. 이름은 공백이거나 서버에 접속한 다른 플레이어의 이름과 중복될 수 없다.

### 대기실 화면
![](https://i.imgur.com/RBwNGhD.gif)
![](https://i.imgur.com/7k58CWD.gif)
'뒤로가기' 버튼을 누르면 초기 화면으로 돌아간다. 게임은 반드시 2인 이상일 때 시작할 수 있다. 우측에는 대기열에 참여한 플레이어들의 이름을 볼 수 있고 클릭 시 해당 플레이어의 카메라 시점을 볼 수 있고 내 플레이어가 이동하거나 공격을 하면 다시 내 플레이어의 시점으로 돌아온다.


### 게임 화면
![](https://i.imgur.com/LAl6jH0.gif)
![](https://i.imgur.com/ILXN2Cn.gif)
![](https://i.imgur.com/2ISCLz6.gif)

방장이 게임 시작 버튼을 누르면, 플레이어는 각자 공격력을 부여받고 타이머가 동작하며 게임이 시작된다. 공격력은 게임에 참여중인 플레이어 수에 맞춰 랜덤으로 유일하게 부여되며, 플레이어는 자신을 제외한 다른 플레이어의 공격력을 해당 캐릭터에 달려 있는 숫자로 확인할 수 있다. 남은 시간은 화면 중앙 상단에 표시된다. 우측 상단에는 플레이어의 Kill 횟수가, 우측 하단에는 현재 살아있는 플레이어 수가 표시된다. 좌측 하단에는 살아있는 플레이어 중 공격력이 가장 낮은 플레이어의 닉네임이 표시된다. 공격력이 가장 낮은 플레이어의 화면에는 추가적으로 도망치라는 안내 문구가 표시된다.

플레이어가 죽으면 왼쪽 상단에 죽은 플레이어의 이름과 공격력이 잠시 동안 킬로그로 뜬다. 죽은 플레이어는 남은 살아있는 플레이어들의 카메라 시점으로 관전할 수 있다.

### 종료 화면
![](https://i.imgur.com/hvdOFKA.gif)

제한 시간이 모두 지났을 경우 공격력이 가장 낮은 꼴등 플레이어가 승리한다. 공격력이 가장 높은 플레이어가 다른 플레이어를 모두 죽였을 경우에는 게임이 즉시 종료되며 공격력이 가장 높은 플레이어가 승리한다. 게임이 종료되면 자동으로 15초 뒤에 초기 화면으로 돌아간다.
***

## 세부 특징
### 조작법
게임 진행 중 플레이어가 할 수 있는 행동은 다음과 같다.
* 상하좌우 이동 (w,s,a,d)
* 공격 (스페이스바)
* 죽은 척 하기 (shift)

### 공격력
N명의 플레이어가 게임을 할 때 각 플레이어에게는 1에서 N사이의 공격력을 하나씩 무작위로 부여된다. 다른 플레이어가 한 명 이상 공격 범위 안에 들어오면 공격 범위를 나타내는 빨간색이 진하게 변한다. 공격력이 서로 다른 두 명 중 한 명이 공격을 시도할 경우 공격력이 낮은 플레이어가 사망하게 된다. 따라서 여러 명이 공격 범위에 존재하는 경우에는 공격자보다 공격력이 낮은 플레이어는 전부 사망하며 공격자보다 공격력이 높은 플레이어가 존재할 경우 공격자 역시 사망하게 된다. 

### 시야
플레이어의 시야는 플레이어를 중심으로 일정 거리로 한정되며 벽에 가려진다.


### 죽은 척 하기
좌측 shift키를 누르면 좀비 캐릭터가 시체 모습으로 바뀌며 잠시 동안 죽은 척을 할 수 있다. 하지만 죽은 척의 지속 시간이 지나 원래의 상태로 돌아오기 전까지는 아무런 조작도 할 수 없기 때문에 신중하게 사용해야 한다.

***
## 구현할 기능
> 앞으로 추가적으로 구현할 기능 & 디버그

* 한 게임을 끝나고 방을 재접속 할 때 로비에서 이름과 공격력이 유지되는 버그 수정 필요
* 텔레포트 기능
* 게임준비 기능
    * 현재는 아무 플레이어나 게임시작 버튼을 누르면 시작됨
* 게임시작시 랜덤 스폰 기능


## 추가된 기능
> 기존 `The Weakest` 에서 추가된 기능 리스트

* 클라이언트의 모든 행동이 유효한 행동인지 서버에서 서버 데이터를 기반으로 모두 검사
* 하나의 게임이 진행중이더라도 다른 방을 생성하여 게임을 할 수 있음
* 방 접속 시 유효 혹은 중복 이름인지 검사

***

## 참고자료

* https://youtu.be/9Bn1C9O0hzY
* https://www.inflearn.com/course/%EC%9C%A0%EB%8B%88%ED%8B%B0-mmorpg-%EA%B0%9C%EB%B0%9C-part4
* https://www.inflearn.com/course/%EC%9C%A0%EB%8B%88%ED%8B%B0-mmorpg-%EA%B0%9C%EB%B0%9C-part7
